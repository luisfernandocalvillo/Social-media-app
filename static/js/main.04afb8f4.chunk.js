(this["webpackJsonpsocial-media-app"]=this["webpackJsonpsocial-media-app"]||[]).push([[0],{80:function(e,t,n){},89:function(e,t,n){"use strict";n.r(t);var r=n(0),c=n.n(r),a=n(12),s=n.n(a),i=(n(80),n(13)),o=n.n(i),u=n(15),l=n(9),j=n(7),b=n(44),d="https://posts-pw2021.herokuapp.com/api/v1",m={};m.login=function(){var e=Object(u.a)(o.a.mark((function e(t,n){var r,c;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("".concat(d,"/auth/signin"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:t,password:n})});case 2:if(!(r=e.sent).ok){e.next=8;break}return e.next=6,r.json();case 6:return c=e.sent,e.abrupt("return",c);case 8:return e.abrupt("return",{});case 9:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),m.verifyToken=function(){var e=Object(u.a)(o.a.mark((function e(t){var n,r;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("".concat(d,"/auth/whoami"),{method:"GET",headers:{Authorization:"Bearer ".concat(t)}});case 2:if(200!==(n=e.sent).status){e.next=8;break}return e.next=6,n.json();case 6:return r=e.sent,e.abrupt("return",r);case 8:return e.abrupt("return",{});case 9:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();var x=m,p=n(2),O=c.a.createContext(),f="token",h=function(e){var t=Object(r.useState)(void 0),n=Object(l.a)(t,2),c=n[0],a=n[1],s=Object(r.useState)(void 0),i=Object(l.a)(s,2),j=i[0],d=i[1];Object(r.useEffect)((function(){var e=function(){var e=Object(u.a)(o.a.mark((function e(){var t,n,r,c;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t=g())){e.next=8;break}return e.next=4,x.verifyToken(t);case 4:n=e.sent,r=n.username,c=n.role,r&&c&&(d({username:r,role:c}),m(t));case 8:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();e()}),[c]);var m=function(e){localStorage.setItem(f,e),a(e)},h=Object(r.useCallback)((function(e,t){var n=function(){var n=Object(u.a)(o.a.mark((function n(){var r,c,a;return o.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return r=!1,n.prev=1,n.next=4,x.login(e,t);case 4:c=n.sent,(a=c.token)&&(m(a),r=!0),n.next=13;break;case 9:n.prev=9,n.t0=n.catch(1),console.error(n.t0),console.error("Error in login");case 13:return n.prev=13,n.abrupt("return",r);case 16:case"end":return n.stop()}}),n,null,[[1,9,13,16]])})));return function(){return n.apply(this,arguments)}}();return n()}),[]),v=Object(r.useCallback)((function(){d(void 0),m(void 0)}),[]),w=Object(r.useMemo)((function(){return{token:c,user:j,login:h,logout:v}}),[c,j,h,v]);return Object(p.jsx)(O.Provider,Object(b.a)({value:w},e))},v=function(){var e=c.a.useContext(O);if(!e)throw new Error("useUserContext() must be inside of UserProvider");return e},g=function(){return localStorage.getItem(f)},w=n.p+"static/media/harbor.bee33a64.jpg",y=function(){var e=v(),t=e.login,n=e.token,c=Object(r.useState)(""),a=Object(l.a)(c,2),s=a[0],i=a[1],b=Object(r.useState)(""),d=Object(l.a)(b,2),m=d[0],x=d[1],O=Object(r.useState)(!1),f=Object(l.a)(O,2),h=f[0],g=f[1],y=Object(j.g)(),N=function(e,t){t(e.target.value)},k=function(){var e=Object(u.a)(o.a.mark((function e(n){var r;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n.preventDefault(),e.next=3,t(s,m);case 3:r=e.sent,g(!r),i(""),x("");case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(r.useEffect)((function(){n&&y("/redirect")}),[n,y]),Object(p.jsxs)("section",{className:"flex md:flex-row flex-col text-center items-center md:justify-around justify-center min-h-screen gap-6 bg-white",children:[Object(p.jsx)("div",{className:"md:block hidden w-5/12",children:Object(p.jsx)("img",{className:"rounded-lg shadow-2xl w-full h-auto",src:w,alt:"Harbor Landscape"})}),Object(p.jsxs)("main",{className:"flex flex-col md:w-5/12 w-3/4 md:p-4 p-1 md:my-auto my-2 bg-white",children:[Object(p.jsx)("p",{className:"md:text-2xl text-xl font-bold md:m-3 mx-3 mb-3 mt-1",children:"Sign in to your account"}),Object(p.jsxs)("div",{className:"divide-y divide-gray-400",children:[Object(p.jsxs)("form",{onSubmit:k,className:"text-center bg-white md:w-4/5 w-full md:pb-6 pb-2 mx-auto",children:[h&&Object(p.jsx)("p",{className:"w-full rounded-lg p-2 mt-3 mb-6 text-center text-white font-roboto bg-red-700 select-none",children:"Try again"}),Object(p.jsx)("p",{className:"text-left my-2",children:"Username"}),Object(p.jsx)("input",{className:"rounded-lg w-full mb-2 p-2 bg-gray-300",type:"text",value:s,placeholder:"Enter your username",onChange:function(e){return N(e,i)}}),Object(p.jsx)("p",{className:"text-left mb-2",children:"Password"}),Object(p.jsx)("input",{className:"rounded-lg w-full mb-2 p-2 bg-gray-300",type:"password",placeholder:"Enter your password",onChange:function(e){return N(e,x)},value:m}),Object(p.jsx)("button",{className:"rounded-lg md:px-20 px-16 py-2 md:my-6 mb-4 mt-1 transition duration-300 ease-in-out bg-blue-200 hover:bg-blue-300",children:"Sign In"})]}),Object(p.jsx)("p",{className:"font-bold md:text-2xl text-xl md:py-8 pt-4 text-gray-300",children:"theforum."})]})]}),Object(p.jsx)("div",{className:"md:hidden md:w-5/12 w-4/6",children:Object(p.jsx)("img",{className:"rounded-lg shadow-2xl w-full h-auto",src:w,alt:"Harbor Landscape"})})]})},N=n(21);var k=function(e){var t=v(),n=Object(j.g)();return Object(p.jsx)("div",{className:"menu-item h-10 items-center text-center rounded-lg p-2 hover:bg-gray-300 cursor-pointer",children:"/login"===e.to?Object(p.jsx)("div",{onClick:function(e){e.preventDefault(),t.logout(),n("/login")},children:e.children}):Object(p.jsx)(N.b,{to:e.to,children:e.children})})};var S=function(e){var t=e.options;return Object(p.jsx)("div",{className:"dropdown absolute right-0 mx-3 w-40 p-3 bg-gray-100 border-2 border-black rounded-lg z-50",children:Object(p.jsx)("div",{children:t.map((function(e){return Object(p.jsx)(k,{to:e.to,children:e.title})}))})})},C=n.p+"static/media/logo.77209732.png";var E=function(e){return Object(p.jsx)("nav",{className:"h-14 bg-blue-100 border-2 border-black rounded-b-lg",children:Object(p.jsxs)("div",{className:"flex flex-row items-center justify-between",children:[Object(p.jsx)("div",{className:"h-14",children:Object(p.jsx)("img",{className:"p-3 h-full",src:C,alt:"navbar_logo"})}),Object(p.jsx)("p",{className:"text-xl font-bold",children:"theforum."}),Object(p.jsx)("div",{className:"h-14",children:Object(p.jsxs)("ul",{className:"p-3 h-full",children:[" ",e.children," "]})})]})})},_=n(116),P=n(120),T=n(126),z=n(121);var F=function(e){var t=e.image,n=e.title,r=e.description,c=e.user;return Object(p.jsx)("div",{className:"post flex max-w-4xl bg-white mx-auto rounded-lg mt-6 mb-1 border-2 border-black p-3",children:Object(p.jsxs)("div",{className:"post_header w-full",children:[Object(p.jsxs)(_.a,{children:[Object(p.jsx)(P.a,{children:Object(p.jsx)(T.a,{className:"post_avatar my-4",src:"https://source.unsplash.com/random",alt:"User"})}),Object(p.jsx)(z.a,{primary:c,secondary:n})]}),Object(p.jsx)("h3",{className:"mx-3 -mt-0 mb-4",children:r}),Object(p.jsx)("div",{className:"max-w-4xl flex justify-center",children:Object(p.jsx)("img",{className:"post_img rounded-lg",src:t,alt:"Post pic"})})]})})},I=n(63),L=n.n(I),A=n(62),B=n.n(A),J=n(64),U=n.n(J);var V=function(){return Object(p.jsxs)("div",{className:"flex justify-between items-center max-w-4xl mx-auto border-2 border-black rounded-lg bg-gray-100 divide-x divide-black",children:[Object(p.jsxs)("div",{className:"flex items-center space-x-1 hover:bg-gray-100 flex-grow justify-center p-2 rounded-l-lg cursor-pointer hover:bg-gray-300",children:[Object(p.jsx)(B.a,{className:"h-4"}),Object(p.jsx)("p",{className:"text-xs sm:text-base",children:"favorite"})]}),Object(p.jsxs)("div",{className:"flex items-center space-x-1 hover:bg-gray-100 flex-grow justify-center p-2 cursor-pointer hover:bg-gray-300",children:[Object(p.jsx)(L.a,{className:"h-4"}),Object(p.jsx)("p",{className:"text-xs sm:text-base",children:"add comment"})]}),Object(p.jsxs)("div",{className:"flex items-center space-x-1 hover:bg-gray-100 flex-grow justify-center rounded-r-lg p-2 cursor-pointer hover:bg-gray-300",children:[Object(p.jsx)(U.a,{className:"h-4"}),Object(p.jsx)("p",{className:"text-xs sm:text-base",children:"like"})]})]})},D=n(50),G=n(123),H=n(122);var M=function(e){var t=e.comment,n=t.description,r=t.user.username;return Object(p.jsx)("div",{className:"max-w-4xl mx-auto",children:Object(p.jsxs)(H.a,{className:"w-full inline max-w-sm",children:[Object(p.jsxs)(_.a,{alignItems:"flex-start",children:[Object(p.jsx)(P.a,{children:Object(p.jsx)(T.a,{alt:"user",src:"https://source.unsplash.com/random"})}),Object(p.jsx)(z.a,{primary:r,secondary:Object(p.jsx)(c.a.Fragment,{children:Object(p.jsxs)(D.a,{component:"span",variant:"body2",className:"inline",color:"textPrimary",children:[" ",n]})})})]}),Object(p.jsx)(G.a,{variant:"inset",component:"li"})]})})},q=n(66),K=n(65),Q=n.n(K),R=n(125),W=n(124),X="https://posts-pw2021.herokuapp.com/api/v1/post",Y=function(){var e=Object(u.a)(o.a.mark((function e(t,n,r){var c,a;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("".concat(X,"/all?limit=").concat(t,"&page=").concat(n),{method:"GET",headers:{Authorization:"Bearer ".concat(r)}});case 2:return c=e.sent,e.next=5,c.json();case 5:return a=e.sent,e.abrupt("return",a);case 7:case"end":return e.stop()}}),e)})));return function(t,n,r){return e.apply(this,arguments)}}(),Z=function(e){return e||null},$=function(){var e=Object(u.a)(o.a.mark((function e(t,n,r){var c,a;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Y(t,n,r);case 2:return c=e.sent,a=c.data.map((function(e){return Z(e)})),console.log(a),e.abrupt("return",a);case 6:case"end":return e.stop()}}),e)})));return function(t,n,r){return e.apply(this,arguments)}}(),ee=function(){var e=Object(u.a)(o.a.mark((function e(t,n,r){var c,a;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("".concat(X,"/comment/").concat(r),{method:"PATCH",headers:{Authorization:"Bearer ".concat(n),"Content-Type":"application/json"},body:JSON.stringify(t)});case 2:return c=e.sent,e.next=5,c.json();case 5:return a=e.sent,e.abrupt("return",a);case 7:case"end":return e.stop()}}),e)})));return function(t,n,r){return e.apply(this,arguments)}}(),te=$;var ne=function(e){var t=e.comments,n=e.setComments,c=e.idPost,a=Object(r.useState)(""),s=Object(l.a)(a,2),i=s[0],j=s[1],d=v().token,m=function(){var e=Object(u.a)(o.a.mark((function e(r){var a;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r.preventDefault(),ee(a={description:i},d,c).then((function(e){console.log(e),n([].concat(Object(q.a)(t),[Object(b.a)(Object(b.a)({},a),{},{user:{username:"gp36_user"}})]))})),j("");case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(p.jsxs)("form",{className:"postComment_box flex max-w-4xl mx-auto mt-5 mb-20 p-2",onSubmit:m,children:[Object(p.jsx)(R.a,{label:"add comment",size:"small",variant:"outlined",className:"post_input flex-1",value:i,onChange:function(e){j(e.target.value)}}),Object(p.jsx)(W.a,{className:"animate-none",variant:"contained",size:"small",endIcon:Object(p.jsx)(Q.a,{})})]})},re=n(34),ce=n.n(re);function ae(e){var t=Object(r.useState)(!1),n=Object(l.a)(t,2),c=n[0],a=n[1];return Object(p.jsxs)("li",{className:"nav-item",children:[Object(p.jsx)("a",{className:"icon-button cursor-pointer",onClick:function(){return a(!c)},children:e.icon}),c&&Object(p.jsx)(S,{options:[{title:"View all",to:"/user"},{title:"Favorites",to:"/favorites"},{title:"Logout",to:"/login"}]})]})}function se(e){var t=e.post,n=t._id,c=t.title,a=t.description,s=t.image,i=t.user,o=t.comments,u=Object(r.useState)(o),j=Object(l.a)(u,2),b=j[0],d=j[1];return Object(p.jsxs)("div",{children:[Object(p.jsx)(F,{title:c,description:a,image:s,user:i.username}),Object(p.jsx)(V,{}),b.map((function(e){return Object(p.jsx)(M,{comment:e})})),Object(p.jsx)(ne,{comments:b,setComments:d,idPost:n})]})}var ie=function(){var e=Object(r.useState)([]),t=Object(l.a)(e,2),n=t[0],c=t[1],a=Object(r.useState)({page:0,limit:200}),s=Object(l.a)(a,2),i=s[0],o=(s[1],v().token);return Object(r.useEffect)((function(){var e=i.page,t=i.limit;te(t,e,o).then((function(e){return c(e)}))}),[]),Object(p.jsxs)(p.Fragment,{children:[Object(p.jsx)(E,{children:Object(p.jsx)(ae,{icon:Object(p.jsx)(ce.a,{}),children:Object(p.jsx)(S,{})})}),n.map((function(e){return Object(p.jsx)(se,{post:e},e._id)}))]})};function oe(e){var t=Object(r.useState)(!1),n=Object(l.a)(t,2),c=n[0],a=n[1];return Object(p.jsxs)("li",{className:"nav-item",children:[Object(p.jsx)("a",{className:"icon-button cursor-pointer",onClick:function(){return a(!c)},children:e.icon}),c&&Object(p.jsx)(S,{options:[{title:"View all",to:"/user"},{title:"Favorites",to:"/favorites"},{title:"Logout",to:"/login"}]})]})}function ue(e){var t=e.post,n=t.title,r=t.description,c=t.image,a=t.user;return Object(p.jsx)("div",{children:Object(p.jsx)(F,{title:n,description:r,image:c,user:a.username})})}var le=function(){var e=Object(r.useState)([]),t=Object(l.a)(e,2),n=t[0],c=t[1],a=Object(r.useState)({page:0,limit:10}),s=Object(l.a)(a,2),i=s[0],o=(s[1],v().token);return Object(r.useEffect)((function(){var e=i.page,t=i.limit;te(t,e,o).then((function(e){return c(e)}))}),[]),Object(p.jsxs)(p.Fragment,{children:[Object(p.jsx)(E,{children:Object(p.jsx)(oe,{icon:Object(p.jsx)(ce.a,{}),children:Object(p.jsx)(S,{})})}),n.map((function(e){return Object(p.jsx)(ue,{post:e},e._id)}))]})};function je(e){var t=Object(r.useState)(!1),n=Object(l.a)(t,2),c=n[0],a=n[1];return Object(p.jsxs)("li",{className:"nav-item",children:[Object(p.jsx)("a",{className:"icon-button cursor-pointer",onClick:function(){return a(!c)},children:e.icon}),c&&Object(p.jsx)(S,{options:[{title:"Create",to:"/create"},{title:"View my posts",to:"/mine"},{title:"View all",to:"/admin"},{title:"Logout",to:"/login"}]})]})}function be(e){var t=e.post,n=t.title,r=t.description,c=t.image,a=t.user;return Object(p.jsx)("div",{children:Object(p.jsx)(F,{title:n,description:r,image:c,user:a.username})})}var de=function(){var e=Object(r.useState)([]),t=Object(l.a)(e,2),n=t[0],c=t[1],a=Object(r.useState)({page:0,limit:10}),s=Object(l.a)(a,2),i=s[0],o=(s[1],v().token);return Object(r.useEffect)((function(){var e=i.page,t=i.limit;te(t,e,o).then((function(e){return c(e)}))}),[]),Object(p.jsxs)(p.Fragment,{children:[Object(p.jsx)(E,{children:Object(p.jsx)(je,{icon:Object(p.jsx)(ce.a,{}),children:Object(p.jsx)(S,{})})}),n.map((function(e){return Object(p.jsx)(be,{post:e},e._id)}))]})},me=n.p+"static/media/errores.36ce7ca5.png",xe=function(){var e=Object(j.g)();return Object(p.jsxs)("div",{className:"flex flex-col justify-center items-center w-screen h-screen bg-gray-100 ",children:[Object(p.jsx)("img",{className:"w-48",src:me,alt:"404"}),Object(p.jsx)("h2",{className:" text-xl font-roboto text-center",children:"Page not found"}),Object(p.jsx)("button",{className:"rounded-lg md:px-20 px-16 py-2 md:my-6 mb-4 mt-1 transition duration-300 ease-in-out bg-blue-200 hover:bg-blue-300",onClick:function(t){e("/login")},children:"Go to Login"})]})},pe={admin:"/admin",user:"/user"},Oe=function(){var e,t=v().user;return t?Object(p.jsx)(j.a,{replace:!0,to:null!==(e=pe[t.role])&&void 0!==e?e:"/"}):Object(p.jsx)("p",{children:" No se puede redireccionar "})},fe=function(e){var t=e.role,n=e.children,r=v(),c=r.token,a=r.user;return c?a&&a.role===t?n:Object(p.jsx)(j.a,{replace:!0,to:"/404"}):Object(p.jsx)(j.a,{replace:!0,to:"/login"})};var he=function(){return Object(p.jsx)(N.a,{children:Object(p.jsxs)(j.d,{children:[Object(p.jsx)(j.b,{path:"/",element:Object(p.jsx)(j.a,{replace:!0,to:"/login"})}),Object(p.jsx)(j.b,{path:"/login",element:Object(p.jsx)(y,{})}),Object(p.jsx)(j.b,{path:"/redirect",element:Object(p.jsx)(Oe,{})}),Object(p.jsx)(j.b,{path:"/user",element:Object(p.jsxs)(fe,{role:"user",children:[" ",Object(p.jsx)(ie,{})," "]})}),Object(p.jsx)(j.b,{path:"/favorites",element:Object(p.jsxs)(fe,{role:"user",children:[" ",Object(p.jsx)(le,{})," "]})}),Object(p.jsx)(j.b,{path:"/admin",element:Object(p.jsx)(fe,{role:"admin",children:Object(p.jsx)(de,{})})}),Object(p.jsx)(j.b,{path:"/404",element:Object(p.jsx)(xe,{})})]})})};s.a.render(Object(p.jsx)(c.a.StrictMode,{children:Object(p.jsx)(h,{children:Object(p.jsx)(he,{})})}),document.getElementById("root"))}},[[89,1,2]]]);
//# sourceMappingURL=main.04afb8f4.chunk.js.map